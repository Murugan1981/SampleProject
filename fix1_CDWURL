def handle_cdw(row):
    """Handles CDW mapping type with explicit URL resolution"""
    values = []
    # Stores CDW response per trade

    for trade_id in simm_df["TRADE_ID"]:
        # Iterate through each trade

        raw_path_template = row["CDWURL"]
        # Example: "/{tradingEntity}/fpml/IntradayTrades/{trade_id}"

        resolved_path = raw_path_template.format(
            tradingEntity=TRADING_ENTITY,
            trade_id=trade_id
        )
        # Replace placeholders explicitly

        final_url = CDW_BASE_URL.rstrip("/") + resolved_path
        # Concatenate base URL and path safely

        print("DEBUG URL BUILD")
        print("CDW_BASE_URL      :", CDW_BASE_URL)
        print("RAW PATH TEMPLATE :", raw_path_template)
        print("RESOLVED PATH     :", resolved_path)
        print("FINAL URL         :", final_url)
        print("-" * 80)
        # Debug prints for troubleshooting

        response = call_cdw(final_url)
        # Invoke CDW call only after clarity

        values.append(response)
        # Append response

    return values
    # Return collected CDW responses
